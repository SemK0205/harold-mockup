(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,30257,e=>{"use strict";var t=e.i(43476),s=e.i(932),a=e.i(71645),l=e.i(69969),n=e.i(87486),r=e.i(27612),i=e.i(40392),o=e.i(22858);e.i(28856);var c=e.i(74050),c=c;let d=(e,t)=>{let s=e instanceof Map?e:new Map(e.entries()),a=t instanceof Map?t:new Map(t.entries());if(s.size!==a.size)return!1;for(let[e,t]of s)if(!a.has(e)||!Object.is(t,a.get(e)))return!1;return!0},u=[{value:"active",label:"In Progress",color:"bg-blue-500"},{value:"quoted",label:"Quote Received",color:"bg-purple-500"},{value:"negotiating",label:"Negotiating",color:"bg-yellow-500"},{value:"closed_success",label:"Deal Done",color:"bg-green-500"},{value:"closed_lost",label:"Lost",color:"bg-red-500"},{value:"cancelled",label:"Cancelled",color:"bg-gray-500"},{value:"no_offer",label:"No Offer",color:"bg-orange-500"}];function m(e){var l;let m,y,j,v,b,N,_,S,w,C,D,q,k,T,$,F,L,O,P,E,A,U,I,B,R,M,z,V,Q,K,G,J,Y,H,W,X,Z,ee,et,es,ea,el,en,er,ei,eo=(0,s.c)(122),{deals:ec,onDealClick:ed,onStatusChange:eu,onDelete:em}=e,[ex,eh]=(0,a.useState)("created_at"),[ep,eg]=(0,a.useState)("desc"),[ef,ey]=(0,a.useState)(null),{viewedDeals:ej,knownDealIds:ev,viewedVersion:eb,markAsViewed:eN}=(0,c.default)((l=f,ei=a.default.useRef(void 0),e=>{let t=l(e);return!function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(Symbol.iterator in e&&Symbol.iterator in t){if("entries"in e&&"entries"in t)return d(e,t);let s=e[Symbol.iterator](),a=t[Symbol.iterator](),l=s.next(),n=a.next();for(;!l.done&&!n.done;){if(!Object.is(l.value,n.value))return!1;l=s.next(),n=a.next()}return!!l.done&&!!n.done}return d({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})}(ei.current,t)?ei.current=t:ei.current}));eo[0]!==ev||eo[1]!==ej?(m=e=>ev.has(e)&&!ej.has(e),eo[0]=ev,eo[1]=ej,eo[2]=m):m=eo[2];let e_=m;eo[3]!==eN||eo[4]!==ed?(y=e=>{eN(e.session_id),ed(e)},eo[3]=eN,eo[4]=ed,eo[5]=y):y=eo[5];let eS=y;eo[6]!==ep||eo[7]!==ex?(j=e=>{ex===e?eg("asc"===ep?"desc":"asc"):(eh(e),eg("desc"))},eo[6]=ep,eo[7]=ex,eo[8]=j):j=eo[8];let ew=j;if(eo[9]!==ec||eo[10]!==ep||eo[11]!==ex){let e;eo[13]!==ep||eo[14]!==ex?(e=(e,t)=>{let s=e[ex],a=t[ex];return null===s?1:null===a?-1:("string"==typeof s&&"string"==typeof a&&(s=s.toLowerCase(),a=a.toLowerCase()),s<a)?"asc"===ep?-1:1:s>a?"asc"===ep?1:-1:0},eo[13]=ep,eo[14]=ex,eo[15]=e):e=eo[15],v=[...ec].sort(e),eo[9]=ec,eo[10]=ep,eo[11]=ex,eo[12]=v}else v=eo[12];let eC=v;eo[16]!==ep||eo[17]!==ex?(b=e=>{let{field:s}=e;return ex!==s?(0,t.jsx)("span",{className:"text-gray-300",children:"â¬"}):"asc"===ep?(0,t.jsx)("span",{children:"â–²"}):(0,t.jsx)("span",{children:"â–¼"})},eo[16]=ep,eo[17]=ex,eo[18]=b):b=eo[18];let eD=b;if(eo[19]!==ew?(N=()=>ew("vessel_name"),eo[19]=ew,eo[20]=N):N=eo[20],eo[21]!==eD?(_=(0,t.jsx)(eD,{field:"vessel_name"}),eo[21]=eD,eo[22]=_):_=eo[22],eo[23]!==N||eo[24]!==_?(S=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:N,className:"flex items-center gap-1 hover:text-blue-600",children:["Vessel ",_]})}),eo[23]=N,eo[24]=_,eo[25]=S):S=eo[25],eo[26]!==ew?(w=()=>ew("port"),eo[26]=ew,eo[27]=w):w=eo[27],eo[28]!==eD?(C=(0,t.jsx)(eD,{field:"port"}),eo[28]=eD,eo[29]=C):C=eo[29],eo[30]!==C||eo[31]!==w?(D=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:w,className:"flex items-center gap-1 hover:text-blue-600",children:["Port ",C]})}),eo[30]=C,eo[31]=w,eo[32]=D):D=eo[32],eo[33]!==ew?(q=()=>ew("delivery_date"),eo[33]=ew,eo[34]=q):q=eo[34],eo[35]!==eD?(k=(0,t.jsx)(eD,{field:"delivery_date"}),eo[35]=eD,eo[36]=k):k=eo[36],eo[37]!==q||eo[38]!==k?(T=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:q,className:"flex items-center gap-1 hover:text-blue-600",children:["ETA ",k]})}),eo[37]=q,eo[38]=k,eo[39]=T):T=eo[39],eo[40]===Symbol.for("react.memo_cache_sentinel")?($=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Fuel"}),F=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Customer"}),L=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Quotes"}),eo[40]=$,eo[41]=F,eo[42]=L):($=eo[40],F=eo[41],L=eo[42]),eo[43]!==ew?(O=()=>ew("status"),eo[43]=ew,eo[44]=O):O=eo[44],eo[45]!==eD?(P=(0,t.jsx)(eD,{field:"status"}),eo[45]=eD,eo[46]=P):P=eo[46],eo[47]!==O||eo[48]!==P?(E=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:O,className:"flex items-center gap-1 hover:text-blue-600",children:["Status ",P]})}),eo[47]=O,eo[48]=P,eo[49]=E):E=eo[49],eo[50]!==ew?(A=()=>ew("created_at"),eo[50]=ew,eo[51]=A):A=eo[51],eo[52]!==eD?(U=(0,t.jsx)(eD,{field:"created_at"}),eo[52]=eD,eo[53]=U):U=eo[53],eo[54]!==A||eo[55]!==U?(I=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:A,className:"flex items-center gap-1 hover:text-blue-600",children:["Created ",U]})}),eo[54]=A,eo[55]=U,eo[56]=I):I=eo[56],eo[57]!==ew?(B=()=>ew("updated_at"),eo[57]=ew,eo[58]=B):B=eo[58],eo[59]!==eD?(R=(0,t.jsx)(eD,{field:"updated_at"}),eo[59]=eD,eo[60]=R):R=eo[60],eo[61]!==B||eo[62]!==R?(M=(0,t.jsx)("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:(0,t.jsxs)("button",{onClick:B,className:"flex items-center gap-1 hover:text-blue-600",children:["Updated ",R]})}),eo[61]=B,eo[62]=R,eo[63]=M):M=eo[63],eo[64]===Symbol.for("react.memo_cache_sentinel")?(z=(0,t.jsx)("th",{className:"px-4 py-3 text-center font-semibold text-gray-700 w-16",children:"Actions"}),eo[64]=z):z=eo[64],eo[65]!==D||eo[66]!==T||eo[67]!==E||eo[68]!==I||eo[69]!==M||eo[70]!==S?(V=(0,t.jsx)("thead",{className:"bg-gray-100 border-b-2 border-gray-200",children:(0,t.jsxs)("tr",{children:[S,D,T,$,F,L,E,I,M,z]})}),eo[65]=D,eo[66]=T,eo[67]=E,eo[68]=I,eo[69]=M,eo[70]=S,eo[71]=V):V=eo[71],eo[72]!==eC.length?(Q=0===eC.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:10,className:"px-4 py-12 text-center text-gray-400",children:"No deals found"})}),eo[72]=eC.length,eo[73]=Q):Q=eo[73],eo[74]!==eS||eo[75]!==e_||eo[76]!==em||eo[77]!==eu||eo[78]!==eC||eo[79]!==ef){let e;eo[81]!==eS||eo[82]!==e_||eo[83]!==em||eo[84]!==eu||eo[85]!==ef?(e=e=>(0,t.jsxs)("tr",{onClick:()=>eS(e),className:`border-b cursor-pointer transition-colors ${function(e){return({active:"bg-blue-50 hover:bg-blue-100",quoted:"bg-purple-50 hover:bg-purple-100",negotiating:"bg-yellow-50 hover:bg-yellow-100",closed_success:"bg-green-50 hover:bg-green-100",closed_lost:"bg-red-50 hover:bg-red-100",cancelled:"bg-gray-50 hover:bg-gray-100",no_offer:"bg-orange-50 hover:bg-orange-100"})[e]}(e.status)}`,children:[(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsxs)("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:[e.vessel_name||"-",e_(e.session_id)&&(0,t.jsx)(n.Badge,{className:"bg-red-500 text-white text-[10px] px-1.5 py-0",children:"NEW"}),(e.buyer_unread_count??0)>0&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-indigo-500 text-white",title:"ì„ ì£¼ì¸¡ ì½ì§€ ì•Šì€ ë©”ì‹œì§€",style:{animation:"scale-ping 1.5s ease-in-out infinite"},children:[(0,t.jsx)(i.Ship,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{className:"text-xs font-bold",children:e.buyer_unread_count})]}),(e.seller_unread_count??0)>0&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-rose-500 text-white",title:"íŒë§¤ì¸¡ ì½ì§€ ì•Šì€ ë©”ì‹œì§€",style:{animation:"scale-ping 1.5s ease-in-out infinite"},children:[(0,t.jsx)(o.Fuel,{className:"w-3.5 h-3.5"}),(0,t.jsx)("span",{className:"text-xs font-bold",children:e.seller_unread_count})]})]})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"text-gray-700",children:e.port||"-"})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"text-gray-700",children:e.delivery_date||"-"})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsxs)("div",{className:"space-y-1",children:[e.fuel_type&&(0,t.jsxs)("div",{className:"text-gray-700",children:[e.fuel_type," ",e.quantity&&`${e.quantity}MT`]}),e.fuel_type2&&(0,t.jsxs)("div",{className:"text-gray-700",children:[e.fuel_type2," ",e.quantity2&&`${e.quantity2}MT`]}),!e.fuel_type&&!e.fuel_type2&&"-"]})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"text-gray-700 truncate max-w-[150px]",children:e.customer_room_name})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"space-y-1",children:e.total_quotes_received>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[e.total_quotes_received," received"]}),e.selected_trader&&(0,t.jsxs)("div",{className:"text-xs font-medium text-green-700",children:["âœ“ ",e.selected_trader]}),e.final_price&&(0,t.jsxs)("div",{className:"text-xs font-bold text-green-600",children:["$",e.final_price.toLocaleString()]})]}):(0,t.jsx)("div",{className:"text-xs text-gray-400",children:"Waiting"})})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),ey(ef===e.session_id?null:e.session_id)},className:"cursor-pointer hover:opacity-80 transition-opacity",children:function(e){return({active:(0,t.jsx)(n.Badge,{className:"bg-blue-500 text-white",children:"In Progress"}),quoted:(0,t.jsx)(n.Badge,{className:"bg-purple-500 text-white",children:"Quote Received"}),negotiating:(0,t.jsx)(n.Badge,{className:"bg-yellow-500 text-black",children:"Negotiating"}),closed_success:(0,t.jsx)(n.Badge,{className:"bg-green-500 text-white",children:"Deal Done"}),closed_lost:(0,t.jsx)(n.Badge,{className:"bg-red-500 text-white",children:"Lost"}),cancelled:(0,t.jsx)(n.Badge,{className:"bg-gray-500 text-white",children:"Cancelled"}),no_offer:(0,t.jsx)(n.Badge,{className:"bg-orange-500 text-white",children:"No Offer"})})[e]}(e.status)}),ef===e.session_id&&(0,t.jsx)("div",{className:"absolute right-0 top-full mt-1 z-50 bg-white border rounded-lg shadow-lg py-1 min-w-[140px]",children:u.map(s=>(0,t.jsxs)("button",{onClick:t=>{t.stopPropagation(),eu&&eu(e.session_id,s.value),ey(null)},className:`w-full text-left px-3 py-1.5 text-xs hover:bg-gray-100 flex items-center gap-2 ${e.status===s.value?"bg-gray-50 font-medium":""}`,children:[(0,t.jsx)("span",{className:`w-2 h-2 rounded-full ${s.color}`}),s.label]},s.value))})]})}),(0,t.jsxs)("td",{className:"px-4 py-3",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString("en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0})}),e.duration_minutes>0&&(0,t.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:[Math.floor(e.duration_minutes/60),"h ",Math.floor(e.duration_minutes%60),"m"]})]}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.updated_at?new Date(e.updated_at).toLocaleString("en-US",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0}):"-"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-center",children:(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),em&&em(e.session_id,e.vessel_name||"Unknown")},className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Delete deal",children:(0,t.jsx)(r.Trash2,{className:"w-4 h-4"})})})]},e.id),eo[81]=eS,eo[82]=e_,eo[83]=em,eo[84]=eu,eo[85]=ef,eo[86]=e):e=eo[86],K=eC.map(e),eo[74]=eS,eo[75]=e_,eo[76]=em,eo[77]=eu,eo[78]=eC,eo[79]=ef,eo[80]=K}else K=eo[80];return eo[87]!==Q||eo[88]!==K?(G=(0,t.jsxs)("tbody",{children:[Q,K]}),eo[87]=Q,eo[88]=K,eo[89]=G):G=eo[89],eo[90]!==V||eo[91]!==G?(J=(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[V,G]})}),eo[90]=V,eo[91]=G,eo[92]=J):J=eo[92],eo[93]!==ec.length?(Y=(0,t.jsxs)("div",{children:["Total: ",(0,t.jsx)("span",{className:"font-bold text-gray-900",children:ec.length})]}),eo[93]=ec.length,eo[94]=Y):Y=eo[94],eo[95]!==ec?(H=ec.filter(g),eo[95]=ec,eo[96]=H):H=eo[96],eo[97]!==H.length?(W=(0,t.jsxs)("span",{children:["In Progress: ",(0,t.jsx)("span",{className:"font-medium text-blue-600",children:H.length})]}),eo[97]=H.length,eo[98]=W):W=eo[98],eo[99]!==ec?(X=ec.filter(p),eo[99]=ec,eo[100]=X):X=eo[100],eo[101]!==X.length?(Z=(0,t.jsxs)("span",{children:["Quoted: ",(0,t.jsx)("span",{className:"font-medium text-purple-600",children:X.length})]}),eo[101]=X.length,eo[102]=Z):Z=eo[102],eo[103]!==ec?(ee=ec.filter(h),eo[103]=ec,eo[104]=ee):ee=eo[104],eo[105]!==ee.length?(et=(0,t.jsxs)("span",{children:["Negotiating: ",(0,t.jsx)("span",{className:"font-medium text-yellow-600",children:ee.length})]}),eo[105]=ee.length,eo[106]=et):et=eo[106],eo[107]!==ec?(es=ec.filter(x),eo[107]=ec,eo[108]=es):es=eo[108],eo[109]!==es.length?(ea=(0,t.jsxs)("span",{children:["Deal Done: ",(0,t.jsx)("span",{className:"font-medium text-green-600",children:es.length})]}),eo[109]=es.length,eo[110]=ea):ea=eo[110],eo[111]!==W||eo[112]!==Z||eo[113]!==et||eo[114]!==ea?(el=(0,t.jsxs)("div",{className:"flex gap-4",children:[W,Z,et,ea]}),eo[111]=W,eo[112]=Z,eo[113]=et,eo[114]=ea,eo[115]=el):el=eo[115],eo[116]!==Y||eo[117]!==el?(en=(0,t.jsxs)("div",{className:"bg-gray-50 px-4 py-3 border-t flex items-center justify-between text-sm text-gray-600",children:[Y,el]}),eo[116]=Y,eo[117]=el,eo[118]=en):en=eo[118],eo[119]!==J||eo[120]!==en?(er=(0,t.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[J,en]}),eo[119]=J,eo[120]=en,eo[121]=er):er=eo[121],er}function x(e){return"closed_success"===e.status}function h(e){return"negotiating"===e.status}function p(e){return"quoted"===e.status}function g(e){return"active"===e.status}function f(e){return{viewedDeals:e.viewedDeals,knownDealIds:e.knownDealIds,viewedVersion:e.viewedVersion,markAsViewed:e.markAsViewed}}var y=e.i(5211),j=e.i(48725),v=e.i(34920),b=e.i(76639),N=e.i(19455),_=e.i(55764),S=e.i(75157);let w=a.forwardRef(({className:e,...s},a)=>(0,t.jsx)("label",{ref:a,className:(0,S.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...s}));w.displayName="Label";var C=e.i(24687),D=e.i(7233),q=e.i(61238);function k({open:e,onClose:s,onSuccess:l}){let[n,r]=(0,a.useState)(!1),[i,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[p,g]=(0,a.useState)(""),[f,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),[S,k]=(0,a.useState)(""),[T,$]=(0,a.useState)(""),[F,L]=(0,a.useState)(""),[O,P]=(0,a.useState)(""),[E,A]=(0,a.useState)(""),U=()=>{d(""),m(""),h(""),g(""),y(""),v(""),k(""),$(""),L(""),P(""),A(""),o(null)},I=async e=>{if(e.preventDefault(),!c.trim())return void o("ê³ ê°/ì„ ì£¼ ì´ë¦„ì€ í•„ìˆ˜ìž…ë‹ˆë‹¤.");r(!0),o(null);try{let e=await fetch(`${(0,q.getApiUrl)()}/sessions/manual`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_name:c.trim(),vessel_name:u.trim()||null,port:x.trim()||null,delivery_date:p.trim()||null,fuel_type:f.trim()||null,quantity:j.trim()||null,fuel_type2:S.trim()||null,quantity2:T.trim()||null,fuel_type3:F.trim()||null,quantity3:O.trim()||null,original_inquiry:E.trim()||null})});if(!e.ok){let t=await e.json();throw Error(t.detail||"ì¸ì¿¼ë¦¬ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}let t=await e.json();console.log("Manual inquiry created:",t),U(),s(),l?.(t.session_id)}catch(e){console.error("Error creating manual inquiry:",e),o(e instanceof Error?e.message:"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{r(!1)}},B=()=>{U(),s()};return(0,t.jsx)(b.Dialog,{open:e,onOpenChange:B,children:(0,t.jsxs)(b.DialogContent,{className:"max-w-lg",children:[(0,t.jsx)(b.DialogHeader,{children:(0,t.jsxs)(b.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(D.Plus,{className:"w-5 h-5"}),"ì¸ì¿¼ë¦¬ ìˆ˜ë™ ì¶”ê°€"]})}),(0,t.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(w,{htmlFor:"customerName",className:"text-sm font-medium",children:["ê³ ê°/ì„ ì£¼ ì´ë¦„ ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(_.Input,{id:"customerName",value:c,onChange:e=>d(e.target.value),placeholder:"ì˜ˆ: ì˜¤ë¦¬ì˜¨, ì§€ì„±ì‰¬í•‘",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"vesselName",className:"text-sm font-medium",children:"ì„ ë°•ëª…"}),(0,t.jsx)(_.Input,{id:"vesselName",value:u,onChange:e=>m(e.target.value),placeholder:"ì˜ˆ: MT SEANERGY",className:"mt-1"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"port",className:"text-sm font-medium",children:"Port"}),(0,t.jsx)(_.Input,{id:"port",value:x,onChange:e=>h(e.target.value),placeholder:"ì˜ˆ: BUSAN, YEOSU",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"deliveryDate",className:"text-sm font-medium",children:"ETA"}),(0,t.jsx)(_.Input,{id:"deliveryDate",value:p,onChange:e=>g(e.target.value),placeholder:"ì˜ˆ: 12-15 DEC",className:"mt-1"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"fuelType",className:"text-sm font-medium",children:"ìœ ì¢… 1"}),(0,t.jsx)(_.Input,{id:"fuelType",value:f,onChange:e=>y(e.target.value),placeholder:"ì˜ˆ: VLSFO, LSMGO",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"quantity",className:"text-sm font-medium",children:"ìˆ˜ëŸ‰ 1"}),(0,t.jsx)(_.Input,{id:"quantity",value:j,onChange:e=>v(e.target.value),placeholder:"ì˜ˆ: 500MT",className:"mt-1"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"fuelType2",className:"text-sm font-medium",children:"ìœ ì¢… 2"}),(0,t.jsx)(_.Input,{id:"fuelType2",value:S,onChange:e=>k(e.target.value),placeholder:"ì˜ˆ: LSMGO",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"quantity2",className:"text-sm font-medium",children:"ìˆ˜ëŸ‰ 2"}),(0,t.jsx)(_.Input,{id:"quantity2",value:T,onChange:e=>$(e.target.value),placeholder:"ì˜ˆ: 100MT",className:"mt-1"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"fuelType3",className:"text-sm font-medium",children:"ìœ ì¢… 3"}),(0,t.jsx)(_.Input,{id:"fuelType3",value:F,onChange:e=>L(e.target.value),placeholder:"ì„ íƒì‚¬í•­",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"quantity3",className:"text-sm font-medium",children:"ìˆ˜ëŸ‰ 3"}),(0,t.jsx)(_.Input,{id:"quantity3",value:O,onChange:e=>P(e.target.value),placeholder:"ì„ íƒì‚¬í•­",className:"mt-1"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(w,{htmlFor:"originalInquiry",className:"text-sm font-medium",children:"ì›ë³¸ ì¸ì¿¼ë¦¬ (ì„ íƒ)"}),(0,t.jsx)(C.Textarea,{id:"originalInquiry",value:E,onChange:e=>A(e.target.value),placeholder:"ì´ë©”ì¼/ì „í™”ë¡œ ë°›ì€ ì›ë³¸ ë‚´ìš©ì„ ìž…ë ¥í•˜ì„¸ìš”...",className:"mt-1",rows:3})]}),i&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:i}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,t.jsx)(N.Button,{type:"button",variant:"outline",onClick:B,children:"ì·¨ì†Œ"}),(0,t.jsx)(N.Button,{type:"submit",disabled:n,children:n?"ì¶”ê°€ ì¤‘...":"ì¸ì¿¼ë¦¬ ì¶”ê°€"})]})]})]})})}let T=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var $=e.i(78583),F=e.i(31278),L=e.i(81949);function O({filters:s={}}){let[l,n]=(0,a.useState)(!1),[r,i]=(0,a.useState)(null),o=async()=>{n(!0),i("csv");try{let e=new URLSearchParams;s.status&&e.append("status",s.status),s.port&&e.append("port",s.port),s.customer&&e.append("customer",s.customer),s.dateFrom&&e.append("date_from",s.dateFrom),s.dateTo&&e.append("date_to",s.dateTo);let t=await L.default.get(`${(0,q.getApiUrl)()}/deals/export/csv?${e.toString()}`,{responseType:"blob"}),a=new Blob([t.data],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(a),n=document.createElement("a");n.href=l;let r=t.headers["content-disposition"],i=r?.match(/filename="?([^"]+)"?/);n.download=i?i[1]:`deals_export_${Date.now()}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(l),console.log("CSV export completed")}catch(e){console.error("CSV export failed:",e),alert("Failed to export CSV.")}finally{n(!1),i(null)}},c=async()=>{n(!0),i("pdf");try{let{jsPDF:t}=await e.A(34162);await e.A(98136);let a=new URLSearchParams;s.status&&a.append("status",s.status),s.port&&a.append("port",s.port),s.customer&&a.append("customer",s.customer);let l=(await L.default.get(`${(0,q.getApiUrl)()}/deals/scoreboard?${a.toString()}`)).data.data||[],n=new t({orientation:"landscape"});n.setFontSize(18),n.text("Deal Scoreboard Report",14,20),n.setFontSize(10),n.text(`Generated: ${new Date().toLocaleString("en-US")}`,14,30);let r=[];s.status&&r.push(`Status: ${s.status}`),s.port&&r.push(`Port: ${s.port}`),s.customer&&r.push(`Customer: ${s.customer}`),r.length>0&&n.text(`Filters: ${r.join(", ")}`,14,36);let i=l.map(e=>[e.customer_room_name||"-",e.vessel_name||"-",e.port||"-",e.fuel_type&&e.quantity?`${e.fuel_type} ${e.quantity}`:"-",e.delivery_date||"-","active"===e.status?"Active":"quoted"===e.status?"Quoted":"negotiating"===e.status?"Negotiating":"closed_success"===e.status?"Success":"closed_lost"===e.status?"Failed":"Cancelled",e.total_quotes_received||0,e.final_price?`$${e.final_price.toLocaleString()}`:"-",e.selected_trader||"-",e.created_at?new Date(e.created_at).toLocaleDateString("en-US"):"-"]);n.autoTable({head:[["Customer","Vessel","Port","Fuel/Qty","ETA","Status","Quotes","Final Price","Trader","Created"]],body:i,startY:45,styles:{font:"helvetica",fontSize:8,cellPadding:2},headStyles:{fillColor:[66,139,202],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]}});let o=n.lastAutoTable.finalY||45;n.setFontSize(10),n.text(`Total ${l.length} deals`,14,o+10);let c=l.filter(e=>"closed_success"===e.status).length,d=l.filter(e=>"active"===e.status).length;n.text(`Success: ${c} | Active: ${d}`,14,o+16);let u=new Date().toISOString().slice(0,10).replace(/-/g,"");n.save(`deals_report_${u}.pdf`),console.log("PDF export completed")}catch(e){console.error("PDF export failed:",e),alert("Failed to export PDF.")}finally{n(!1),i(null)}};return(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(N.Button,{variant:"outline",size:"sm",onClick:o,disabled:l,className:"flex items-center gap-1.5",children:[l&&"csv"===r?(0,t.jsx)(F.Loader2,{className:"w-3.5 h-3.5 animate-spin"}):(0,t.jsx)($.FileText,{className:"w-3.5 h-3.5"}),"Export CSV"]}),(0,t.jsxs)(N.Button,{variant:"outline",size:"sm",onClick:c,disabled:l,className:"flex items-center gap-1.5",children:[l&&"pdf"===r?(0,t.jsx)(F.Loader2,{className:"w-3.5 h-3.5 animate-spin"}):(0,t.jsx)(T,{className:"w-3.5 h-3.5"}),"Export PDF"]})]})}var P=e.i(66027),E=e.i(8069),A=e.i(70480),c=c;function U(e){let t=A.useDealStore.getState();e.forEach(e=>{e.session_id&&e.seller_contexts&&t.setSellerContexts(e.session_id,e.seller_contexts)})}function I(e,t){let s=c.default.getState();t?s.setKnownDeals(e.map(e=>e.session_id)):e.forEach(e=>{s.addKnownDeal(e.session_id)&&s.showNotification("New Deal Request",{body:`${e.vessel_name||"Unknown Vessel"} - ${e.port||"Unknown Port"}`,tag:`deal-${e.session_id}`})})}var c=c;function B(){let e,n,r,i,o,d,u,x,h,p,g,f,b,S=(0,s.c)(114),[w,C]=(0,a.useState)("table"),[T,$]=(0,a.useState)(""),[F,L]=(0,a.useState)(""),[E,A]=(0,a.useState)(""),[B,Q]=(0,a.useState)(null),[K,G]=(0,a.useState)(!1),[J,Y]=(0,a.useState)(!1),H=F||void 0,W=T||void 0,X=E||void 0;S[0]!==H||S[1]!==W||S[2]!==X?(e={port:H,status:W,customer:X},S[0]=H,S[1]=W,S[2]=X,S[3]=e):e=S[3];let{deals:Z,isConnected:ee}=function(e={}){let{port:t,status:s,customer:l,enabled:n=!0}=e,[r,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),m=(0,a.useRef)(null),x=(0,a.useRef)(null),h=(0,a.useCallback)(()=>{if(!n)return;m.current&&m.current.close(),x.current&&clearTimeout(x.current);let e=new URLSearchParams;t&&e.append("port",t),s&&e.append("status",s),l&&e.append("customer",l);let a=new EventSource(`${(0,q.getApiUrl)()}/api/deals/stream${e.toString()?`?${e.toString()}`:""}`);m.current=a,a.onopen=()=>{c(!0),u(null)},a.addEventListener("initial_data",e=>{try{let t=JSON.parse(e.data).deals||[];i(t),U(t),I(t,!0)}catch(e){console.error("Failed to parse initial_data:",e)}}),a.addEventListener("deal_update",e=>{try{let t=JSON.parse(e.data).deals||[];i(t),U(t),I(t,!1)}catch(e){console.error("Failed to parse deal_update:",e)}}),a.addEventListener("heartbeat",()=>{}),a.onerror=()=>{c(!1),u("Connection lost"),a.close(),x.current=setTimeout(()=>{h()},5e3)}},[n,t,s,l]),p=(0,a.useCallback)(()=>{h()},[h]);return(0,a.useEffect)(()=>(h(),()=>{m.current&&m.current.close(),x.current&&clearTimeout(x.current)}),[h]),{deals:r,isConnected:o,error:d,reconnect:p}}(e),[et,es]=(0,a.useState)(!1),{notificationPermission:ea,requestNotificationPermission:el,initNotificationPermission:en}=(0,c.default)();S[4]!==en?(n=()=>{es(!0),en()},r=[en],S[4]=en,S[5]=n,S[6]=r):(n=S[5],r=S[6]),(0,a.useEffect)(n,r),S[7]===Symbol.for("react.memo_cache_sentinel")?(i={queryKey:["deals","statistics"],queryFn:V,refetchInterval:3e4},S[7]=i):i=S[7];let{data:er,isLoading:ei}=(0,P.useQuery)(i);if(S[8]!==E||S[9]!==Z||S[10]!==ee||S[11]!==et||S[12]!==ea||S[13]!==F||S[14]!==el||S[15]!==B||S[16]!==er||S[17]!==ei||S[18]!==T||S[19]!==w){let e,s,a,n,r,i,c,h,p,g,f,b,q,k,P,U,I,R,V,K,J,H,W,X,es,en,eo=B&&Z.find(e=>e.session_id===B)||null;S[24]===Symbol.for("react.memo_cache_sentinel")?(e=e=>{Q(e.session_id),G(!0)},S[24]=e):e=S[24];let ec=e;d=l.MainLayout,S[25]===Symbol.for("react.memo_cache_sentinel")?(s=(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Deal Scoreboard"}),S[25]=s):s=S[25];let ed=`w-2 h-2 rounded-full animate-pulse ${ee?"bg-green-500":"bg-red-500"}`;S[26]!==ed?(a=(0,t.jsx)("span",{className:ed}),S[26]=ed,S[27]=a):a=S[27];let eu=ee?"Live":"Connecting...";S[28]!==eu?(n=(0,t.jsx)("span",{className:"text-gray-600",children:eu}),S[28]=eu,S[29]=n):n=S[29],S[30]!==a||S[31]!==n?(r=(0,t.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-gray-100 text-xs",children:[a,n]}),S[30]=a,S[31]=n,S[32]=r):r=S[32],S[33]!==et||S[34]!==ea||S[35]!==el?(i=et&&"granted"!==ea&&"unsupported"!==ea&&(0,t.jsxs)(N.Button,{variant:"outline",size:"sm",onClick:el,className:"flex items-center gap-1.5",children:[(0,t.jsx)("span",{children:"ðŸ””"}),(0,t.jsx)("span",{children:"Enable Notifications"})]}),S[33]=et,S[34]=ea,S[35]=el,S[36]=i):i=S[36],S[37]!==et||S[38]!==ea?(c=et&&"granted"===ea&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-green-50 text-xs text-green-700",children:[(0,t.jsx)("span",{children:"ðŸ””"}),(0,t.jsx)("span",{children:"Notifications On"})]}),S[37]=et,S[38]=ea,S[39]=c):c=S[39],S[40]!==r||S[41]!==i||S[42]!==c?(h=(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[s,r,i,c]}),S[40]=r,S[41]=i,S[42]=c,S[43]=h):h=S[43],S[44]===Symbol.for("react.memo_cache_sentinel")?(p=()=>Y(!0),S[44]=p):p=S[44],S[45]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsxs)(N.Button,{variant:"default",size:"sm",onClick:p,className:"flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(D.Plus,{className:"w-4 h-4"}),"Add Inquiry"]}),S[45]=g):g=S[45],S[46]!==E||S[47]!==F||S[48]!==T||S[49]!==w?(f="table"===w&&(0,t.jsx)(O,{filters:{status:T,port:F,customer:E}}),S[46]=E,S[47]=F,S[48]=T,S[49]=w,S[50]=f):f=S[50],S[51]!==Z.length?(b=(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Total ",Z.length," deals"]}),S[51]=Z.length,S[52]=b):b=S[52];let em="table"===w?"default":"outline";S[53]===Symbol.for("react.memo_cache_sentinel")?(q=()=>C("table"),S[53]=q):q=S[53],S[54]!==em?(k=(0,t.jsx)(N.Button,{variant:em,size:"sm",onClick:q,children:"Table"}),S[54]=em,S[55]=k):k=S[55];let ex="timeline"===w?"default":"outline";S[56]===Symbol.for("react.memo_cache_sentinel")?(P=()=>C("timeline"),S[56]=P):P=S[56],S[57]!==ex?(U=(0,t.jsx)(N.Button,{variant:ex,size:"sm",onClick:P,children:"Timeline"}),S[57]=ex,S[58]=U):U=S[58];let eh="statistics"===w?"default":"outline";S[59]===Symbol.for("react.memo_cache_sentinel")?(I=()=>C("statistics"),S[59]=I):I=S[59],S[60]!==eh?(R=(0,t.jsx)(N.Button,{variant:eh,size:"sm",onClick:I,children:"Statistics"}),S[60]=eh,S[61]=R):R=S[61],S[62]!==k||S[63]!==U||S[64]!==R?(V=(0,t.jsxs)("div",{className:"flex gap-2",children:[k,U,R]}),S[62]=k,S[63]=U,S[64]=R,S[65]=V):V=S[65],S[66]!==f||S[67]!==b||S[68]!==V?(K=(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[g,f,b,V]}),S[66]=f,S[67]=b,S[68]=V,S[69]=K):K=S[69],S[70]!==h||S[71]!==K?(J=(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[h,K]}),S[70]=h,S[71]=K,S[72]=J):J=S[72],S[73]!==E||S[74]!==F||S[75]!==T||S[76]!==w?(H=("table"===w||"timeline"===w)&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-gray-600 mb-1 block",children:"Port"}),(0,t.jsx)(_.Input,{placeholder:"Filter by port (e.g. Busan)",value:F,onChange:e=>L(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-gray-600 mb-1 block",children:"Customer"}),(0,t.jsx)(_.Input,{placeholder:"Filter by customer (e.g. ORION)",value:E,onChange:e=>A(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-gray-600 mb-1 block",children:"Status"}),(0,t.jsxs)("select",{className:"w-full h-9 px-3 border border-gray-200 rounded-md text-sm",value:T,onChange:e=>$(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"All"}),(0,t.jsx)("option",{value:"active",children:"Active"}),(0,t.jsx)("option",{value:"quoted",children:"Quoted"}),(0,t.jsx)("option",{value:"negotiating",children:"Negotiating"}),(0,t.jsx)("option",{value:"no_offer",children:"No Offer"}),(0,t.jsx)("option",{value:"closed_success",children:"Success"}),(0,t.jsx)("option",{value:"closed_lost",children:"Lost"}),(0,t.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(F||E||T)&&(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)(N.Button,{variant:"outline",size:"sm",onClick:()=>{L(""),A(""),$("")},children:"Clear Filters"})})]}),S[73]=E,S[74]=F,S[75]=T,S[76]=w,S[77]=H):H=S[77],S[78]!==Z.length||S[79]!==ee||S[80]!==w?(W=!ee&&0===Z.length&&("table"===w||"timeline"===w)&&(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Loading..."})}),S[78]=Z.length,S[79]=ee,S[80]=w,S[81]=W):W=S[81],S[82]!==Z||S[83]!==ee||S[84]!==w?(X="table"===w&&(ee||Z.length>0)&&(0,t.jsx)(m,{deals:Z,onDealClick:ec,onStatusChange:z,onDelete:M}),S[82]=Z,S[83]=ee,S[84]=w,S[85]=X):X=S[85],S[86]!==Z||S[87]!==ee||S[88]!==w?(es="timeline"===w&&(ee||Z.length>0)&&(0,t.jsx)(j.DealTimeline,{deals:Z,onDealClick:ec}),S[86]=Z,S[87]=ee,S[88]=w,S[89]=es):es=S[89],S[90]!==er||S[91]!==ei||S[92]!==w?(en="statistics"===w&&(0,t.jsx)(y.DealStatistics,{statistics:er,isLoading:ei}),S[90]=er,S[91]=ei,S[92]=w,S[93]=en):en=S[93],S[94]!==J||S[95]!==H||S[96]!==W||S[97]!==X||S[98]!==es||S[99]!==en?(x=(0,t.jsxs)("div",{className:"space-y-6",children:[J,H,W,X,es,en]}),S[94]=J,S[95]=H,S[96]=W,S[97]=X,S[98]=es,S[99]=en,S[100]=x):x=S[100],o=v.DealDetailModal,u=function(e){return e?{session_id:e.session_id,customer_room_name:e.customer_room_name,original_inquiry:"",port:e.port,fuel_type:e.fuel_type,vessel_name:e.vessel_name,imo:e.imo||null,quantity:e.quantity,fuel_type2:e.fuel_type2,quantity2:e.quantity2,delivery_date:e.delivery_date,requested_traders:e.requested_traders||[],quotes:e.quotes||[],status:"active"===e.status?"active":"closed",created_at:e.created_at,closed_at:e.closed_at,seller_contexts:e.seller_contexts,stage:e.stage}:null}(eo),S[8]=E,S[9]=Z,S[10]=ee,S[11]=et,S[12]=ea,S[13]=F,S[14]=el,S[15]=B,S[16]=er,S[17]=ei,S[18]=T,S[19]=w,S[20]=o,S[21]=d,S[22]=u,S[23]=x}else o=S[20],d=S[21],u=S[22],x=S[23];return S[101]===Symbol.for("react.memo_cache_sentinel")?(h=()=>G(!1),S[101]=h):h=S[101],S[102]!==o||S[103]!==K||S[104]!==u?(p=(0,t.jsx)(o,{session:u,open:K,onClose:h}),S[102]=o,S[103]=K,S[104]=u,S[105]=p):p=S[105],S[106]===Symbol.for("react.memo_cache_sentinel")?(g=()=>Y(!1),S[106]=g):g=S[106],S[107]!==J?(f=(0,t.jsx)(k,{open:J,onClose:g,onSuccess:R}),S[107]=J,S[108]=f):f=S[108],S[109]!==d||S[110]!==p||S[111]!==f||S[112]!==x?(b=(0,t.jsxs)(d,{children:[x,p,f]}),S[109]=d,S[110]=p,S[111]=f,S[112]=x,S[113]=b):b=S[113],b}function R(e){console.log("Manual inquiry created:",e)}async function M(e,t){if(confirm(`ì •ë§ë¡œ "${t}" ë”œì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{let t=await fetch(`${(0,q.getApiUrl)()}/deals/${e}`,{method:"DELETE"});t.ok?console.log(`Deal ${e} deleted successfully`):(console.error("Failed to delete deal:",await t.text()),alert("ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."))}catch(e){console.error("Error deleting deal:",e),alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}async function z(e,t){try{let s=await fetch(`${(0,q.getApiUrl)()}/sessions/${e}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});s.ok?console.log(`Status changed to ${t} for session ${e}`):console.error("Failed to update status:",await s.text())}catch(e){console.error("Error updating status:",e)}}function V(){return E.dealScoreboardAPI.getStatistics()}e.s(["default",()=>B],30257)}]);